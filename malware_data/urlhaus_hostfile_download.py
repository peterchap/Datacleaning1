import polars as pl
import requests

url = "https://urlhaus.abuse.ch/downloads/hostfile/"

r = requests.get(url)
df = pl.read_csv(r.content, skip_rows=9, has_header=False, new_columns=["record"])

df1 = df.sql("""SELECT record, SUBSTR(record, 11,) AS domain FROM self""")
print(df.shape)
print(df1["domain"])
